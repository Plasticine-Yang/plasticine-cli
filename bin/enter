#! /usr/bin/env node

const chalk = require('chalk');
const { program } = require('commander');
const figlet = require('figlet');

// 初始化
program
  .name('plasticine-cli')
  .usage(`<command> [option]`)
  .version(`plasticine-cli ${require('../package.json').version}`);

// =============== 配置命令 ===============

// create
program
  .command('create <project-name>')
  .description('create a new project')
  .option('-f, --force', 'overwrite target directory if it exists', false)
  .action((projctName, cmd) => {
    require('../lib/create.js')(projctName, cmd);
  });

// config
program
  .command('config [value]')
  .description('inspect and modify the config')
  .option('-g --get <key>', 'get value by key')
  .option('-s --set <key> <value>', 'set option[key] is value')
  .option('-d --delete <key>', 'delete option by key')
  .action((value, keys) => {
    console.log(value, keys);
  });

// =============== 监听命令 ===============
program.on('--help', () => {
  console.log();
  console.log(
    figlet.textSync('plasticine-cli', {
      font: 'Big Money-ne',
    })
  );
  console.log();
  console.log(
    `Run ${chalk.cyan(
      'plasticine-cli <command> --help'
    )} for detailed usage of given command.`
  );
  console.log();
});

// 解析参数
program.parse(process.argv);
